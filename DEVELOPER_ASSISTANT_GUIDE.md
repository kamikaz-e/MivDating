# Руководство по использованию AI-ассистента разработчика

## Обзор

В проекте MivDating реализован AI-ассистент разработчика с следующими возможностями:
- **RAG** - семантический поиск по документации проекта
- **MCP** - интеграция с git для получения информации о ветках
- **Команда /help** - быстрая справка о проекте

## Компоненты системы

### 1. RAG для документации

#### Что индексируется:
- `README.md` - основная информация о проекте
- `project/docs/PROJECT_STRUCTURE.md` - структура проекта
- `project/docs/API_REFERENCE.md` - справка по API
- `project/docs/CODE_STYLE.md` - стиль кода
- `RAG_COMPLETE_GUIDE.md` - руководство по RAG
- `RAG_FILTERING_GUIDE.md` - руководство по фильтрации
- `TESTING_GUIDE.md` - руководство по тестированию
- `CHANGES_SUMMARY.md` - сводка изменений

#### Установка и использование:

##### Шаг 1: Установите зависимости
```bash
# Python 3.7+ требуется
pip install requests
```

##### Шаг 2: Запустите Ollama
```bash
# Убедитесь, что Ollama запущен
./start-ollama.sh

# Или вручную:
ollama serve
```

##### Шаг 3: Проиндексируйте документацию
```bash
cd project/docs
python3 rag_indexer.py index
```

Вывод:
```
=== Индексация документов проекта ===

✓ Загружен README.md (3542 символов)
✓ Загружен PROJECT_STRUCTURE.md (4123 символов)
✓ Загружен API_REFERENCE.md (7856 символов)
...

=== Индексация завершена ===
Всего проиндексировано чанков: 87
✓ Индекс сохранен в rag_index.json
```

##### Шаг 4: Тестируйте поиск
```bash
python3 rag_indexer.py test
```

или выполните конкретный запрос:
```bash
python3 rag_indexer.py search "Как работает фильтрация в RAG?"
```

#### Примеры использования RAG:

```python
from rag_indexer import search

# Поиск информации
results = search("Где находится IndexingService?", top_k=5)

for result in results:
    print(f"Score: {result['score']:.3f}")
    print(f"Источник: {result['source']}")
    print(f"Текст: {result['content'][:200]}...")
```

### 2. MCP для Git

MCP (Model Context Protocol) сервер предоставляет информацию о текущей git ветке.

#### Установка:

##### Python версия (рекомендуется):
```bash
cd project/docs
chmod +x mcp_git_server.py
```

##### Тестирование:
```bash
python3 mcp_git_server.py test
```

Вывод:
```
=== Тест MCP Git Server ===

1. Текущая ветка:
   lesson_19

2. Информация о ветке:
{
  "current_branch": "lesson_19",
  "status": "## lesson_19",
  "last_commit": "485e5fc Поправил неправильные номера у источников",
  "all_branches": [
    "lesson_19",
    "main"
  ]
}
```

#### Использование с Claude Code:

MCP сервер можно запустить для интеграции с Claude Code:
```bash
python3 mcp_git_server.py
```

Сервер будет слушать stdin и отвечать через stdout в формате JSON-RPC.

#### Доступные инструменты:

1. **git_current_branch** - получает имя текущей ветки
2. **git_branch_info** - получает детальную информацию (статус, последний коммит, список веток)

### 3. Команда /help

Быстрая справка о проекте через Claude Code.

#### Использование:

В терминале Claude Code просто введите:
```
/help
```

Затем задайте вопрос о проекте, например:
```
Как работает RAG система?
```

#### Как это работает:

1. Команда `/help` загружается из `.claude/commands/help.md`
2. Ассистент автоматически читает нужные файлы документации
3. Находит релевантную информацию
4. Дает точный ответ на основе документов
5. Указывает источники

#### Примеры вопросов:

**Архитектура:**
- "Какая архитектура используется в проекте?"
- "Где находятся ViewModel'и?"
- "Какие слои есть в приложении?"

**API:**
- "Какие методы есть у IndexingService?"
- "Какие параметры принимает FilterConfig?"
- "Как использовать searchWithFilter()?"

**Стиль кода:**
- "Как именовать Composable функции?"
- "Какой порядок элементов в классе?"
- "Как обрабатывать ошибки в Coroutines?"

**RAG система:**
- "Как работает фильтрация результатов?"
- "Какой порог фильтрации рекомендуется?"
- "Что такое reranking по длине?"

**Сборка:**
- "Как запустить debug сборку?"
- "Какие команды gradlew доступны?"

## Полный workflow работы с ассистентом

### Сценарий 1: Изучение нового функционала

1. Запустите `/help`
2. Спросите: "Как работает фильтрация в RAG?"
3. Получите ответ с примерами из API_REFERENCE.md
4. Уточните: "Покажи пример использования FilterConfig"
5. Получите код из документации

### Сценарий 2: Поиск по документации через RAG

```bash
# Индексируйте документы (один раз)
cd project/docs
python3 rag_indexer.py index

# Ищите нужную информацию
python3 rag_indexer.py search "Какие параметры у фильтра"

# Результаты покажут релевантные части документации
```

### Сценарий 3: Проверка текущей ветки через MCP

```bash
# Запустите MCP сервер в тестовом режиме
python3 mcp_git_server.py test

# Или интегрируйте с вашим workflow
# Текущая ветка: lesson_19
```

### Сценарий 4: Быстрая справка во время разработки

В процессе кодирования:
```
/help Какой стиль именования для констант?
```

Ответ:
```
Константы именуются в UPPER_SNAKE_CASE.

Пример из CODE_STYLE.md:
const val CHUNK_SIZE = 512
const val DEFAULT_THRESHOLD = 0.7f

Источник: project/docs/CODE_STYLE.md
```

## Настройка и конфигурация

### RAG настройки

Файл: `project/docs/rag_indexer.py`

```python
# Настройки по умолчанию
OLLAMA_URL = "http://localhost:11434"
EMBEDDING_MODEL = "nomic-embed-text"
CHUNK_SIZE = 512
CHUNK_OVERLAP = 128
```

Вы можете изменить:
- `EMBEDDING_MODEL` - модель для эмбеддингов
- `CHUNK_SIZE` - размер чанков
- `CHUNK_OVERLAP` - перекрытие чанков

### MCP настройки

Файл: `project/docs/mcp_git_server.py`

MCP сервер не требует настройки, работает из коробки.

### Команда /help

Файл: `.claude/commands/help.md`

Вы можете изменить:
- Список доступных документов
- Инструкции для ассистента
- Примеры вопросов
- Формат ответа

## Добавление новой документации

Чтобы добавить новую документацию в RAG:

1. Создайте markdown файл в `project/docs/`
2. Переиндексируйте документацию:
```bash
cd project/docs
python3 rag_indexer.py index
```

3. Обновите список в `.claude/commands/help.md`

## Troubleshooting

### RAG не находит документы

**Проблема:** `Ошибка: индекс не найден`

**Решение:**
```bash
cd project/docs
python3 rag_indexer.py index
```

### Ollama не отвечает

**Проблема:** `Ошибка получения эмбеддинга`

**Решение:**
```bash
# Проверьте, запущен ли Ollama
curl http://localhost:11434/api/version

# Если нет, запустите
./start-ollama.sh
```

### MCP сервер не запускается

**Проблема:** Permission denied

**Решение:**
```bash
chmod +x project/docs/mcp_git_server.py
```

### Команда /help не работает

**Проверьте:**
1. Существует ли файл `.claude/commands/help.md`
2. Используете ли вы Claude Code CLI
3. Правильно ли набрана команда: `/help` (с слешем)

## Метрики и статистика

### RAG индекс:
- Всего документов: 8
- Всего чанков: ~87
- Размер индекса: ~2-5 MB
- Время индексации: ~30-60 сек

### Производительность поиска:
- Время поиска: ~50-100ms
- Top-5 результатов
- Точность: зависит от запроса

## Best Practices

### Для RAG:
1. Переиндексируйте после обновления документации
2. Используйте конкретные вопросы для лучших результатов
3. Проверяйте score результатов (>0.7 - хорошо)

### Для /help:
1. Задавайте четкие, конкретные вопросы
2. Уточняйте контекст (API, UI, архитектура)
3. Просите примеры кода если нужно

### Для MCP:
1. Используйте для проверки текущего состояния
2. Интегрируйте в CI/CD если нужно

## Расширение функционала

### Добавление новых RAG источников:

Отредактируйте `load_documents()` в `rag_indexer.py`:
```python
# Добавьте новые файлы
for guide_name in ["YOUR_NEW_GUIDE.md"]:
    guide_path = PROJECT_ROOT / guide_name
    if guide_path.exists():
        documents.append((guide_name, content))
```

### Добавление новых MCP инструментов:

Отредактируйте `MCPGitServer` в `mcp_git_server.py`:
```python
self.tools["new_tool"] = {
    "name": "new_tool",
    "description": "Описание инструмента",
    "inputSchema": {...}
}
```

### Создание новых команд:

Создайте файл `.claude/commands/mycommand.md` с инструкциями.

## Заключение

AI-ассистент разработчика предоставляет:
- ✅ Быстрый доступ к документации через RAG
- ✅ Информацию о git ветке через MCP
- ✅ Мгновенную справку через команду /help
- ✅ Семантический поиск по документам
- ✅ Простую расширяемость

Используйте эти инструменты для повышения продуктивности разработки!

## Следующие шаги

1. Проиндексируйте документацию: `python3 project/docs/rag_indexer.py index`
2. Протестируйте MCP: `python3 project/docs/mcp_git_server.py test`
3. Попробуйте команду: `/help`
4. Задайте вопрос о проекте!

---

Для дополнительной информации см. документацию в `project/docs/`.
